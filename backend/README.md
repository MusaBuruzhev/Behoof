# Behoof Backend API

–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ Behoof, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏.

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Node.js** - JavaScript runtime
- **Express.js** - –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Node.js
- **MongoDB** - NoSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Mongoose** - ODM –¥–ª—è MongoDB
- **Multer** - Middleware –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- **CORS** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **Dotenv** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js >= 20.19.0 || >= 22.12.0
- MongoDB
- npm

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd backend
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø–∞–ø–∫–∏ `backend/`:
```env
PORT=5000
MONGODB_URI=mongodb://localhost:27017/behoof
FRONTEND_URL=http://localhost:5173
```

### 3. –ó–∞–ø—É—Å–∫ MongoDB
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MongoDB –∑–∞–ø—É—â–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ.

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å nodemon)
npm run dev

# –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º
npm start
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:5000`

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–π URL
```
http://localhost:5000/api
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### üè™ –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤

##### –ü–æ–ª—É—á–∏—Ç—å –≤–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥
```http
GET /catalog
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "categories": [
    {
      "id": "cat1",
      "name": "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
      "subcategoryIds": ["sub1", "sub2"]
    }
  ],
  "subcategories": {
    "sub1": {
      "id": "sub1",
      "name": "Apple",
      "categoryId": "cat1",
      "productIds": ["p1", "p2"],
      "isAllCategory": false
    }
  },
  "products": {
    "p1": {
      "id": "p1",
      "name": "iPhone 15 Pro",
      "price": 1399,
      "brand": "Apple",
      "categoryId": "cat1",
      "subcategoryId": "sub1",
      "traitRatings": {
        "–¥–∏–∑–∞–π–Ω": 5,
        "–±–∞—Ç–∞—Ä–µ—è": 4
      },
      "images": ["/uploads/image1.jpg", "/uploads/image2.jpg"]
    }
  }
}
```

#### ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

##### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
```http
POST /products
Content-Type: multipart/form-data
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã:**
- `name` (string, required) - –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- `price` (number, required) - –¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞
- `brand` (string, required) - –ë—Ä–µ–Ω–¥ —Ç–æ–≤–∞—Ä–∞
- `categoryId` (string, required) - ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `images` (file[], required) - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ (3-10 —Ñ–∞–π–ª–æ–≤)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (JavaScript):**
```javascript
const formData = new FormData();
formData.append('name', 'iPhone 15 Pro');
formData.append('price', '1399');
formData.append('brand', 'Apple');
formData.append('categoryId', 'cat1');
formData.append('images', file1);
formData.append('images', file2);

fetch('/api/products', {
  method: 'POST',
  body: formData
});
```

**–û—Ç–≤–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—Ö–µ:**
```json
{
  "message": "–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω",
  "product": {
    "id": "p1",
    "name": "iPhone 15 Pro",
    "price": 1399,
    "brand": "Apple",
    "images": ["/uploads/image1.jpg", "/uploads/image2.jpg"],
    "traitRatings": {
      "–¥–∏–∑–∞–π–Ω": 3,
      "–±–∞—Ç–∞—Ä–µ—è": 3
    }
  }
}
```

#### üìñ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

##### –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä –ø–æ ID
```http
GET /products/:id
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (string) - ID —Ç–æ–≤–∞—Ä–∞

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "p1",
  "name": "iPhone 15 Pro",
  "price": 1399,
  "brand": "Apple",
  "categoryId": "cat1",
  "subcategoryId": "sub1",
  "traitRatings": {
    "–¥–∏–∑–∞–π–Ω": 5,
    "–±–∞—Ç–∞—Ä–µ—è": 4
  },
  "images": ["/uploads/image1.jpg", "/uploads/image2.jpg"]
}
```

#### ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

##### –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
```http
PUT /products/:id
Content-Type: application/json
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (string) - ID —Ç–æ–≤–∞—Ä–∞ –≤ URL

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "name": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "price": 1299,
  "traitRatings": {
    "–¥–∏–∑–∞–π–Ω": 4,
    "–±–∞—Ç–∞—Ä–µ—è": 5
  },
  "images": ["/uploads/new-image.jpg"]
}
```

#### üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

##### –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
```http
DELETE /products/:id
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (string) - ID —Ç–æ–≤–∞—Ä–∞

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω"
}
```

#### üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

##### –°–æ–∑–¥–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```http
POST /initialize
```

–°–æ–∑–¥–∞–µ—Ç 8 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–í—Å–µ [–ö–∞—Ç–µ–≥–æ—Ä–∏—è]".

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "–ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã"
}
```

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ categoryTraits.js  # –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
‚îÇ   ‚îú‚îÄ‚îÄ controllers/     # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ catalogController.js
‚îÇ   ‚îú‚îÄ‚îÄ models/          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö MongoDB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Category.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Subcategory.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Product.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Counter.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.js
‚îÇ   ‚îú‚îÄ‚îÄ routes/          # –ú–∞—Ä—à—Ä—É—Ç—ã API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ catalogRoutes.js
‚îÇ   ‚îî‚îÄ‚îÄ utils/           # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ idGenerator.js
‚îú‚îÄ‚îÄ .env                 # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ server.js            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### Category (–ö–∞—Ç–µ–≥–æ—Ä–∏—è)
```javascript
{
  id: String,           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (cat1, cat2, ...)
  name: String,         // –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  subcategoryIds: [String] // –ú–∞—Å—Å–∏–≤ ID –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
}
```

#### Subcategory (–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è)
```javascript
{
  id: String,           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (sub1, sub2, ...)
  name: String,         // –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  categoryId: String,   // ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  productIds: [String], // –ú–∞—Å—Å–∏–≤ ID —Ç–æ–≤–∞—Ä–æ–≤
  isAllCategory: Boolean // –§–ª–∞–≥ "–í—Å–µ —Ç–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
}
```

#### Product (–¢–æ–≤–∞—Ä)
```javascript
{
  id: String,           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (p1, p2, ...)
  name: String,         // –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
  price: Number,        // –¶–µ–Ω–∞
  brand: String,        // –ë—Ä–µ–Ω–¥
  categoryId: String,   // ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  subcategoryId: String,// ID –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  traitRatings: Object, // –†–µ–π—Ç–∏–Ω–≥–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
  images: [String]      // –ü—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
}
```

#### Counter (–°—á–µ—Ç—á–∏–∫)
```javascript
{
  name: String,         // –ù–∞–∑–≤–∞–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ (p, sub, cat)
  value: Number         // –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
}
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤

–ö–∞–∂–¥–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:

```javascript
const CATEGORY_TRAITS = {
  cat1: ['–¥–∏–∑–∞–π–Ω', '–±–∞—Ç–∞—Ä–µ—è', '–¥–∏—Å–ø–ª–µ–π', '–∫–∞–º–µ—Ä–∞', '–æ—Ç–∑—ã–≤', '–ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å'], // –°–º–∞—Ä—Ç—Ñ–æ–Ω—ã
  cat2: ['–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '—ç–∫—Ä–∞–Ω', '–∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å', '–≤–µ—Å', '–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞', '–æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ'], // –ù–æ—É—Ç–±—É–∫–∏
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
}
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–∫—Ä–∏–ø—Ç—ã
```bash
npm run dev    # –ó–∞–ø—É—Å–∫ —Å nodemon (–∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)
npm start      # –ü—Ä–æ–¥–∞–∫—à–Ω –∑–∞–ø—É—Å–∫
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `PORT` - –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5000)
- `MONGODB_URI` - URI –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB
- `FRONTEND_URL` - URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –¥–ª—è CORS

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- **–ü–∞–ø–∫–∞:** `public/uploads/`
- **–§–æ—Ä–º–∞—Ç—ã:** JPEG, PNG, WebP
- **–†–∞–∑–º–µ—Ä:** –¥–æ 5MB –Ω–∞ —Ñ–∞–π–ª
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** 3-10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä
- **–ò–º–µ–Ω–∞:** `timestamp-random.ext`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏:
```json
{
  "error": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–µ—Ä–≤–µ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB
- –ó–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- –û—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```bash
POST http://localhost:5000/api/initialize
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```bash
POST http://localhost:5000/api/products
Content-Type: multipart/form-data

# –í —Ç–µ–ª–µ —Ñ–æ—Ä–º—ã: name, price, brand, categoryId, images[]
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞
```bash
GET http://localhost:5000/api/catalog
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤:** —Ç–∏–ø, —Ä–∞–∑–º–µ—Ä, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- **CORS:** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤
- **MongoDB:** —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ Mongoose
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤ –∫–æ–¥–µ

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

ISC
